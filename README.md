# Probability Map–based Grape Detection and Counting
This repository is the official implementation of our paper: [Probability Map–based Grape Detection and Counting](https://temp)

## Datasets
`Datasets used in training and testing of our methods`: [BaiduYun](https://pan.baidu.com/s/1ytr9z5FXEchZ7bpdPCA_Wg)(code:36ci) 

BC: The BpGC dataset, generated by finding the grape-berry annotations contained in each grape cluster, that is, covered by the mask of each grape cluster, and regard those berries and that cluster as an integral berry-per-grape-cluster annotation. 

WGISD: The ground truth WGISD generated with the method used in 'Decoupled Two-Stage Crowd Counting and Beyond'.

## Weights
`Model weight files`: [BaiduYun](https://pan.baidu.com/s/165fcNHIJNW_e_xNOzvqcGg)(code:vzau)  

best_ap.pth.tar: The model weight with the best grape-cluster detection performance. 

best_mae.pth.tar: The model weight with the best grape-berry counting performance. 

best_mrd.pth.tar: The model weight with the best berry-per-grape-cluster counting performance. 

## Project Setup
Download the datasets and the model weights, unzip them into the same folder as the source code. Use `'train.py'` to do model training, use `'test_vis.py'` to do evaluation.
